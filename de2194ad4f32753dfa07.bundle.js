(()=>{"use strict";var e=document.querySelector("#tetris-grid"),t=[],n=document.querySelector("#mini-grid"),r=[],o=10;function a(e){return a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a(e)}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,l(r.key),r)}}function l(e){var t=function(e){if("object"!=a(e)||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=a(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==a(t)?t:t+""}var c=function(){return e=function e(t,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.shapes=t,this.type=n,this.origin=-6,this.rotationIndex=0,this.fallInterval=null},n=[{key:"cells",get:function(){var e=this;return this.shapes[this.rotationIndex].map((function(t){return e.origin+t}))}},{key:"renderTetromino",value:function(){var e=this;this.cells.forEach((function(n){t[n]&&t[n].classList.add("tetromino-cell",e.type)}))}},{key:"clearTetromino",value:function(){var e=this;this.cells.forEach((function(n){t[n]&&t[n].classList.remove("tetromino-cell",e.type)}))}},{key:"moveLeft",value:function(){this.cells.every((function(e){return e%o!=0&&!E.has(e-1)}))&&(this.clearTetromino(),this.origin-=1,this.renderTetromino())}},{key:"moveRight",value:function(){this.cells.every((function(e){return e%10!=9&&!E.has(e+1)}))&&(this.clearTetromino(),this.origin+=1,this.renderTetromino())}},{key:"moveDown",value:function(){this.cells.every((function(e){return e+o<t.length&&!E.has(e+o)}))&&(this.clearTetromino(),this.origin+=o,this.renderTetromino())}},{key:"rotate",value:function(){var e=this,t=(this.rotationIndex+1)%this.shapes.length,n=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,r=e.origin+n,a=e.shapes[t].map((function(e){return r+e})),i=r%o,l=a.every((function(e){var t=e%o,n=Math.floor(e/o),r=t>=0&&t<o,a=n>=0&&n<20,i=!E.has(e);return r&&a&&i})),c=a.every((function(e){return Math.floor(e/o)===Math.floor(r/o)||Math.abs(e%o-i)<=3}));return!(!l||!c||(e.clearTetromino(),e.origin=r,e.rotationIndex=t,e.renderTetromino(),0))};n(0)||n(-1)||n(1)||n(-2)||n(2)}},{key:"fall",value:function(){var e=this,t=Math.max(100,500-50*(w-1));this.fallInterval=setInterval((function(){k||(e.cells.every((function(e){return e+10<200&&!E.has(e+10)}))?(e.clearTetromino(),e.origin+=10,e.renderTetromino()):(e.lockTetromino(),clearInterval(e.fallInterval)))}),t)}},{key:"lockTetromino",value:function(){this.cells.forEach((function(e){E.add(e)})),x(),function(){for(var e=t.length-o;e>=0;e-=o){for(var n=[],r=0;r<o;r++)n.push(e+r);if(n.every((function(e){return E.has(e)}))){n.forEach((function(e){E.delete(e),t[e].className="grid-cell"})),q+=10,d.textContent=q,(I+=1)%10==0&&(w+=1,g(),b());for(var a=e-1;a>=0;a--)if(E.has(a)){E.delete(a),E.add(a+o);var i=Array.from(t[a].classList).filter((function(e){return"grid-cell"!==e}));t[a+o].className="grid-cell "+i.join(" "),t[a].className="grid-cell"}e+=o}}}()}}],n&&i(e.prototype,n),Object.defineProperty(e,"prototype",{writable:!1}),e;var e,n}(),s=[{shape:[[0,10,20,21],[-1,0,1,9],[0,1,11,21],[1,9,10,11]],type:"L"},{shape:[[0,1,o,20],[-1,0,1,11],[0,o,19,20],[9,19,20,21]],type:"J"},{shape:[[1,11,21,31],[o,11,12,13]],type:"I"},{shape:[[0,1,11,12],[1,o,11,20]],type:"Z"},{shape:[[0,1,9,o],[-1,9,o,20]],type:"S"},{shape:[[1,o,11,12],[1,11,12,21],[o,11,12,21],[1,o,11,21]],type:"T"},{shape:[[-1,0,9,o]],type:"O"}];function u(){var e=Math.floor(Math.random()*s.length),t=s[e];return new c(t.shape,t.type)}var d=document.querySelector("#game-score"),m=document.querySelector("#btn-pause"),f=document.querySelector("#pause-overlay"),v=document.querySelector("#game-over__modal"),h=document.querySelector("#submission-feedback"),y=document.createElement("img");y.classList.add("game-result-image");var p={L:[2,7,12,13],J:[2,3,7,12],I:[2,7,12,17],Z:[6,7,12,13],S:[7,8,11,12],T:[7,11,12,13],O:[6,7,11,12]};function g(){document.querySelector("#game-level").textContent=w}function b(){var e=document.querySelector("#level-up-animation");e.classList.remove("level-up-hidden"),e.classList.add("level-up-show"),setTimeout((function(){e.classList.remove("level-up-show"),e.classList.add("level-up-hidden")}),1500)}m.addEventListener("click",(function(){T||(k=!k,m.textContent=k?"Resume":"Pause",f.style.visibility=k?"visible":"hidden")}));var S,L,k=!1,T=!1,E=new Set,w=1,q=0,I=0;function x(){var e;T||(L||(L=u()),S=L,L=u(),e=L,r.forEach((function(e){e.className="mini-grid-cell"})),p[e.type].forEach((function(t){r[t]&&r[t].classList.add("tetromino-cell",e.type)})),S.cells.some((function(e){return e>=0&&E.has(e)}))?function(){var e;T=!0,clearInterval(S.fallInterval),document.querySelector("#final-score").textContent=q;var t=document.querySelector("#add-name__form");document.querySelector("#submission-feedback").innerHTML="";var n,r=JSON.parse(localStorage.getItem("leaderboard"))||[];q>0&&(r.length<10||q>(null===(e=r[r.length-1])||void 0===e?void 0:e.score))?t.style.display="block":(t.style.display="none",(n=document.createElement("p")).innerHTML="Almost legendary! Try again!",n.classList.add("low-score-message"),y.src="../images/oops.png",h.append(y,n)),v.showModal()}():(S.renderTetromino(),S.fall()))}document.addEventListener("keydown",(function(e){T||k||("ArrowLeft"===e.key&&S.moveLeft(),"ArrowRight"===e.key&&S.moveRight(),"Enter"===e.key&&S.rotate(),"ArrowDown"===e.key&&S.moveDown(),console.log(e.key))}));var M=document.querySelector("#add-name__form"),_=document.querySelector("#final-score"),C=document.querySelector("#leaderboard-list"),N=document.querySelector("#play-again__button");function O(){var e=JSON.parse(localStorage.getItem("leaderboard"))||[];C.innerHTML="",e.forEach((function(e){var t=document.createElement("li");t.textContent="".concat(e.name," - ").concat(e.score),C.appendChild(t)}))}M.addEventListener("submit",(function(e){e.preventDefault();var t=M.elements.player.value.trim(),n=M.elements.player;if(!t)return n.classList.add("shake"),void setTimeout((function(){n.classList.remove("shake")}),400);var r=localStorage.getItem("leaderboard"),o=r?JSON.parse(r):[],a=o.find((function(e){return e.score===q}));a?a.name=t:o.push({name:t,score:q}),o.sort((function(e,t){return t.score-e.score})),o=o.slice(0,5),localStorage.setItem("leaderboard",JSON.stringify(o)),O(),_.textContent=q,M.elements.player.value="",M.style.display="none",y.src="../images/success_name-submitted.png",h.appendChild(y)})),O(),N.addEventListener("click",(function(){document.querySelector("#game-over__modal").close(),E.clear(),q=0,d.textContent=0,T=!1,I=0,w=1,g(),t.forEach((function(e){e.className="grid-cell"})),x()})),function(){for(var n=0;n<200;n++){var r=document.createElement("div");r.classList.add("grid-cell"),t.push(r),e.append(r)}}(),function(){for(var e=0;e<20;e++){var t=document.createElement("div");t.classList.add("mini-grid-cell"),r.push(t),n.append(t)}}(),x()})();
//# sourceMappingURL=de2194ad4f32753dfa07.bundle.js.map